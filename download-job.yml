parameters:
  id: ''
  downloadType: 'single'
  itermPattern: ''

jobs:
- job: ${{ parameters.id }}
  variables:
    TEST_DESCRIPTION: ${{ parameters.description }}
    ARTIFACT: ${{ parameters.artifactName }}
    PATTERN: ${{ parameters.itemPattern }}
    DOWNLOAD_TYPE: ${{ parameters.downloadType }}
  steps:
  - task: DownloadBuildArtifacts@0
    inputs:
      downloadPath: '$(Build.SourcesDirectory)/results'
      artifactName: '$(ARTIFACT)'
      itemPattern: '$(PATTERN)'
      downloadType: '$(DOWNLOAD_TYPE)'
    continueOnError: true
  
  - bash: |
      echo "======================================================="
      echo "All artifacts:"
      cd files
      grep -r -l "." | sort
      mv a1 b1
      mv a2 b2
      mv a3 b3
      grep -r -l "." | sort
      echo "======================================================="
      echo "Downloaded artifacts (artifact=${ARTIFACT}, pattern=${PATTERN}):"
      cd ../results/${ARTIFACT} && grep -r -l "." | sort
      echo "======================================================="
    displayName: 'Results'
    continueOnError: true